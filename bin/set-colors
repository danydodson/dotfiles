#!/usr/bin/env bash

# Create colors scheme files for multiple tools

# path to the directory containing color scheme scripts
COLORSCHEME_DIR=~/.dotfiles/colors/list

# path to the colorscheme-set script
COLORS_SET_SCRIPT=~/.dotfiles/colors/colors-set.sh

# ensure fzf is installed
if ! command -v fzf &>/dev/null; then
  echo "fzf is not installed. Please install it first."
  exit 1
fi

# list available color scheme scripts
schemes=()
while IFS= read -r -d '' file; do
  schemes+=("$(basename "$file")")
done < <(find "$COLORSCHEME_DIR" -maxdepth 1 -name '*.sh' -print0)

# check if any schemes are available
if [ ${#schemes[@]} -eq 0 ]; then
  echo "No color scheme scripts found in $COLORSCHEME_DIR."
  exit 1
fi

# use fzf to select a scheme
selected_scheme=$(printf "%s\n" "${schemes[@]}" | fzf --height=40% --reverse --header="Select a Color Scheme" --prompt="Theme > ")

# check if a selection was made
if [ -z "$selected_scheme" ]; then
  echo "No color scheme selected."
  exit 0
fi

# apply the selected color scheme
"$COLORS_SET_SCRIPT" "$selected_scheme"
